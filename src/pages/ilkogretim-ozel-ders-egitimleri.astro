---
import Layout from '../layouts/Layout.astro';
import { courses as ilkogretimCourses } from '../data/courses-ilkogretim';

// TÃ¼m kurslarÄ± tek bir diziye topla ve ana kategori ekle
const tumKurslar = [
  ...ilkogretimCourses.map(c => ({ ...c, anaKategori: 'Ä°lkÃ¶ÄŸretim' }))
];

// Kategorilere gÃ¶re grupla
const kategoriler = {};
tumKurslar.forEach(kurs => {
  const kat = kurs.anaKategori;
  if (!kategoriler[kat]) kategoriler[kat] = [];
  kategoriler[kat].push(kurs);
});

// Kategorileri istenen sÄ±raya koy
const kategoriSirasi = ['BiliÅŸim', 'Dil EÄŸitimi', 'Ä°lkÃ¶ÄŸretim', 'Spor', 'Sanat', 'SÄ±nav HazÄ±rlÄ±k', 'DiÄŸer'];
---

<Layout title="TÃ¼m EÄŸitimler | Ä°stanbul EÄŸitim Merkezi">
  <div class="max-w-7xl mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">TÃ¼m EÄŸitimler</h1>
    <p class="text-gray-600 mb-8">Kariyerinize yÃ¶n verin, kurslarÄ±mÄ±zÄ± ve profesyonel eÄŸitmenlerimizi keÅŸfedin.</p>

    <!-- Kategoriler -->
    <div class="space-y-12">
      {kategoriSirasi.map(kategoriAdi => {
        const kurslar = kategoriler[kategoriAdi];
        if (!kurslar || kurslar.length === 0) return null;

        // Kategori iÃ§in ikon belirle
        const ikon = {
          'BiliÅŸim': 'ğŸ’»',
          'Dil EÄŸitimi': 'ğŸ—£ï¸',
          'Ä°lkÃ¶ÄŸretim': 'ğŸ“š',
          'Spor': 'âš½',
          'Sanat': 'ğŸ¨',
          'SÄ±nav HazÄ±rlÄ±k': 'ğŸ“',
          'DiÄŸer': 'ğŸ”§'
        }[kategoriAdi] || 'ğŸ“˜';

        return (
          <section key={kategoriAdi}>
            <h2 class="text-2xl font-bold text-gray-800 mb-6 pb-2 border-b-2 border-indigo-200 flex items-center gap-2">
              <span>{ikon}</span>
              <span>{kategoriAdi}</span>
              <span class="text-sm font-normal text-gray-500 ml-2">({kurslar.length} kurs)</span>
            </h2>

            {/* Kart Grid GÃ¶rÃ¼nÃ¼mÃ¼ (sabit, liste gÃ¶rÃ¼nÃ¼mÃ¼ yok) */}
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {kurslar.map(kurs => {
                // En dÃ¼ÅŸÃ¼k ve en yÃ¼ksek fiyatÄ± bul
                const fiyatlar = kurs.instructors.map(i => i.privatePrice);
                const minFiyat = Math.min(...fiyatlar);
                const maxFiyat = Math.max(...fiyatlar);
                const fiyatMetin = minFiyat === maxFiyat ? `${minFiyat}â‚º` : `${minFiyat}â‚º - ${maxFiyat}â‚º`;

                return (
                  <a href={`/kurs/${kurs.slug}`} class="group bg-white rounded-xl shadow-md hover:shadow-xl transition-all border border-gray-100 overflow-hidden">
                    <img src={kurs.image} alt={kurs.title} class="w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300" />
                    <div class="p-4">
                      <div class="flex items-center gap-2 text-sm text-indigo-600 mb-1">
                        <span>{ikon}</span>
                        <span class="font-medium">{kurs.breadcrumb.split('>')[0]}</span>
                      </div>
                      <h3 class="font-semibold text-gray-800 group-hover:text-indigo-600 transition-colors line-clamp-2">
                        {kurs.title}
                      </h3>
                      <p class="text-sm text-gray-500 mt-2 line-clamp-2">{kurs.description}</p>
                      <div class="mt-3 flex items-center justify-between">
                        <span class="text-indigo-600 font-bold">{fiyatMetin}</span>
                        <span class="text-xs text-gray-400">{kurs.instructors.length} eÄŸitmen</span>
                      </div>
                    </div>
                  </a>
                );
              })}
            </div>
          </section>
        );
      })}
    </div>
  </div>
</Layout>

<style>
  /* Tailwind'de line-clamp yoksa ekleyelim */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>